<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer in LocalStorage</title>
</head>
<style>
    body {
        background-color: #e1e1e1;
    }

    .title {
        text-align: center;
        color: white;
        background-color: rgb(82, 126, 82);
    }

    .highlight {
        background-color: green;
        transition: background-color 0.5s ease;
    }

    .task_title {
        background-color: rgb(125, 176, 125);
        font-weight: bolder;
        font-size: large;
    }

    .task_content {
        display: flex;
        background-color: rgb(199, 233, 199);
    }

    .task_content p {
        flex: 1;
        border: 1px solid black;
        text-align: center;
    }
</style>

<body>
    <h1 class="title">Task Manager</h1>
    <label for="tasks">
        Task:
        <input type="text" name="task" id="task">
    </label>
    <button onclick="entryTimer()"> Pause Timer </button>
    <div id="timerData"></div>
</body>
<script>
    let timer_start = new Date();
    function highlightInput() {
        let input = document.getElementById("task");
        input.classList.add("highlight");
        setTimeout(() => {
            input.classList.remove("highlight");
        }, 500);
    }
    function startTimer() {

    }

    function entryTimer() {
        highlightInput();
        let key = "timer";
        let timer_end = new Date();
        let tmpTime;
        let timer = localStorage.getItem(key);

        if (!timer) {
            tmpTime = [{
                "start_time": timer_start,
                "end_time": timer_end,
                "wasted": `seconds wasted: ${(timer_end - timer_start) / 1000}`,
                "task": document.getElementById("task").value
            }];
            localStorage.setItem(key, JSON.stringify(tmpTime));
        } else {
            tmpTime = {
                "start_time": timer_start,
                "end_time": timer_end,
                "wasted": `seconds wasted: ${(timer_end - timer_start) / 1000}`,
                "task": document.getElementById("task").value
            };
            let tmp = JSON.parse(timer);
            tmp.unshift(tmpTime);
            localStorage.setItem(key, JSON.stringify(tmp));
        }

        timer_start = new Date();
        displayTimerData();
    }
    function displayTimerData() {
        let key = "timer";
        let timerData = JSON.parse(localStorage.getItem(key));
        let timerDataContainer = document.getElementById("timerData");
        timerDataContainer.innerHTML = ""; // Clear previous content

        if (timerData) {
            timerData.forEach(data => {
                let div = document.createElement("div");
                let minutes = (parseFloat(data.wasted.split(':')[1]) / 60);
                let hours = (parseFloat(data.wasted.split(':')[1]) / 3600);
                div.innerHTML = `
                        <p class='task_title'>Task: ${data.task}</p>
                        <div class='task_content'>
                        <p>Start Time: ${data.start_time}</p>
                        <p>End Time: ${data.end_time}</p>
                        <p>Wasted Time In Seconds: ${data.wasted.split(':')[1]}</p>
                        <p>Wasted Time In Minutes: ${minutes}</p>
                        <p>Wasted Time In Hours: ${hours}</p>
                        <p>Wasted Time <br> Hours: ${Math.trunc(hours)} Minutes: ${Math.trunc(minutes - (Math.trunc(hours) * 60))}</p>
                        </div>
                        <hr>
                    `;
                timerDataContainer.appendChild(div);
            });
        }
    }

    // Initial display on page load
    displayTimerData();
</script>

</html>